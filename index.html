<!DOCTYPE html>
<html lang="zh-Hant-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- <script src="./javascripts/vendor.js"></script> -->
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/redux/4.2.0/redux.min.js"
      integrity="sha512-1/8Tj23BRrWnKZXeBruk6wTnsMJbi/lJsk9bsRgVwb6j5q39n0A00gFjbCTaDo5l5XrPVv4DZXftrJExhRF/Ug=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>

    <title>現在想打球</title>
    <link rel="stylesheet" href="./stylesheets/css/style-scss.css" />
    <style>
      .fileName {
        display: none;
      }
    </style>
    <!-- 載入axios套件 -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- jQ -->
    <!-- <script src="./javascripts/jquery-3.7.1.min.js"></script> -->
    <!-- 輪播套件 -->
    <!-- <link rel="stylesheet" type="text/css" charset="UTF-8" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/slick.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/slick-theme.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-slick/0.28.1/react-slick.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-slick/0.28.1/react-slick.min.js"></script>
    <script crossorigin src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script> -->
  </head>

  <body id="body">
    <small class="fileName">檔名：<code>index.html</code></small>

    <div id="root"></div>
    <script type="text/babel">
      (async () => {
        // const Slider = window["react-slick"];

        const { useState, useEffect, useRef, useMemo } = React;

        //取得json資料
        const data = await axios.get("./postData_test.json");
        const { postData } = data.data;
        console.log(postData);
        const { vb_today_postData } = postData[0];
        const { vb_week_postData } = postData[1];
        const { bm_today_postData } = postData[2];
        const { bm_week_postData } = postData[3];

        /* 建立元件 footer元件 */
        const Footer = (props) => {
          return (
            <>
              <footer>
                <figure className="footer-border"></figure>
                <div>
                  <figure>
                    <img
                      id="logo"
                      src="../../images/logo.png"
                      alt="logo-PlayBallNow"
                    />
                  </figure>
                  <p>Copyright© 2024 PlayBallNow. All Right Reserved. </p>
                </div>
              </footer>
            </>
          );
        };
        const App = () => {
          // const [backgroundImage, setBackgroundImage] = useState("url('../images/CatBg.jpg')");
          const [mainColor, setMainColor] = useState("#14AAEB");
          const [fontColor, setFontColor] = useState("#147CB6");
          const [btnColor, setBtnColor] = useState("#F1DB15");
          const [inputColor, setInputColor] = useState("#B1C3E8");
          const [postBorder, setPostBorder] = useState(
            'url("./images/catsroke.svg")'
          );
          const [decorateSearch, setDecorateSearch] = useState(
            'url("../../images/index-searchCat.png")'
          );
          const [mobileTopBar, setMobileTopBar] = useState(
            "../../images/mobiletopvb.svg"
          );
          /* 要map的資料 */
          const [todayType, setTodayType] = useState("vb_today_postData");
          const [weekType, setWeekType] = useState("vb_week_postData");
          /* 選擇的類型對應要顯示的資料 */
          const [selectedButton, setSelectedButton] = useState("btn-typeVb");
          const [BMdisplay, setBMDisplay] = useState("none");
          const [VBdisplay, setVBDisplay] = useState("flex");
          /* 更多連結 */
          const [hrefTodayMore, setHrefTodayMore] = useState(
            "./VBtodayMore-postsArea.html"
          );
          const [hrefWeekMore, setHrefWeekMore] = useState(
            "./VBweekMore-postsArea.html"
          );
          //篩選的tag值
          const [filterTag, setFilterTag] = useState("排球");
          //程度tag
          const [degreeTag, setdegreeTag] = useState("B");
          //篩選後map的資料
          const [filterTagMap, setfilterTagMap] = useState("");

          const btnTypeVbRef = useRef(null);
          const btnTypeBmRef = useRef(null);

          /* 改變類型(羽/排) */
          const changeType = (id) => {
            // let newBackground = "";
            let colorMain = "";
            let colorFont = "";
            let btnColor = "";
            let inputColor = "";
            let newBorder = "";
            let decorate = "";
            let topBanner = "";
            /* 更多的連結 */
            let hrefTodayMore = "./VBtodayMore-postsArea.html";
            let hrefWeekMore = "./VBweekMore-postsArea.html";

            // 取消其他按鈕的選擇
            const btnTypeVb = document.getElementById("btn-typeVb");
            const btnTypeBm = document.getElementById("btn-typeBm");
            const bodyStyle = document.getElementById("body");

            if (id === "btn-typeBm" || id === "btn-formBM") {
              // 如果是羽球:
              colorMain = "#83B90F";
              colorFont = "#689607";
              btnColor = "#FF8D24";
              inputColor = "#B6DBAA";
              newBorder = 'url("../../images/dogstroke.svg")';
              decorate = 'url("../../images/index-searchDog.png")';
              topBanner = "../../images/mobiletopbm.png";
              // 新增class改變背景
              //bodyStyle.classList.add("background-Bm");
              //bodyStyle.classList.remove("background-Vb");
              setSelectedButton(id);
              /* 改變要map的資料名稱 */
              setTodayType("bm_today_postData");
              setWeekType("bm_week_postData");
              setFilterTag("羽球");
              // banner顯示狀態
              setBMDisplay("flex");
              setVBDisplay("none");
              //更多的連結
              hrefTodayMore = "./BMtodayMore-postsArea.html";
              hrefWeekMore = "./BMweekMore-postsArea.html";
              //羽球程度
              setdegreeTag("初階");
            } else if (id === "btn-typeVb" || id === "btn-formVB") {
              // 如果是排球
              colorMain = "#14AAEB";
              colorFont = "#147CB6";
              btnColor = "#F1DB15";
              inputColor = "#B1C3E8";
              newBorder = "url('../../images/catsroke.svg')";
              decorate = 'url("../../images/index-searchCat.png")';
              topBanner = "../../images/mobiletopvb.svg";
              //
              //bodyStyle.classList.remove("background-Bm");
              //bodyStyle.classList.add("background-Vb");
              setSelectedButton(id);
              //
              setTodayType("vb_today_postData");
              setWeekType("vb_week_postData");
              setFilterTag("排球");
              //
              setBMDisplay("none");
              setVBDisplay("block");
              //
              hrefTodayMore = "./VBtodayMore-postsArea.html";
              hrefWeekMore = "./VBweekMore-postsArea.html";
              //程度
              setdegreeTag("B");
            }

            setMainColor(colorMain);
            setFontColor(colorFont);
            setBtnColor(btnColor);
            setInputColor(inputColor);
            setPostBorder(newBorder);
            setDecorateSearch(decorate);
            setMobileTopBar(topBanner);

            document.documentElement.style.setProperty(
              "--main-color",
              colorMain
            );
            document.documentElement.style.setProperty(
              "--font-color",
              colorFont
            );
            document.documentElement.style.setProperty("--btn-color", btnColor);
            document.documentElement.style.setProperty(
              "--search-decorate",
              decorate
            );
            document.documentElement.style.setProperty(
              "--input-hover-color",
              inputColor
            );
            // document.documentElement.style.setProperty(
            //   "--mobileTop-image",
            //   topBanner
            // );
            setHrefTodayMore(hrefTodayMore);
            setHrefWeekMore(hrefWeekMore);
          };
          // 更改資料類型
          const getPosts = (type) => {
            switch (type) {
              case "vb_today_postData":
                return vb_today_postData;
              case "bm_today_postData":
                return bm_today_postData;
              case "vb_week_postData":
                return vb_week_postData;
              case "bm_week_postData":
                return bm_week_postData;
              default:
                return [];
            }
          };

          useEffect(() => {
            console.log(
              `本日資料類型: ${todayType} , 本週資料類型: ${weekType}`
            );
          }, [weekType, todayType]);

          /* tag篩選 */
          //取得tag對應資料屬性
          const [tagDataType, setTagDataType] = useState("type");
          //篩選本日程度
          const [filterDegree, setFilterDegree] = useState("");
          //篩選本週程度
          const [weekfilterDegree, setweekFilterDegree] = useState("");
          //篩選本日價格
          const [filterPrice, setFilterPrice] = useState("");
          //篩選本週價格
          const [weekfilterPrice, setweekFilterPrice] = useState("");
          //篩選本日時段
          const [filterTime, setFilterTime] = useState("");
          //篩選本週時段
          const [weekfilterTime, setweekFilterTime] = useState("");
          //篩選台北
          const [filterTaipei, setFilterTaipei] = useState("");
          //篩選新北
          const [filterXinpei, setFilterXinpei] = useState("");

          //儲存篩選條件
          const [conditions, setConditions] = useState({ type: filterTag });
          //儲存週篩選條件
          const [weekConditions, setweekConditions] = useState({
            type: filterTag,
          });

          //如果useState改變就加入進condition儲存(避免比對空值)
          const newConditions = {};
          const newWeekConditions = {};
          const allBtn = document.getElementById("tags-All");
          const week_allBtn = document.getElementById("tags-weekAll");
          useEffect(() => {
            if (filterDegree !== "") {
              newConditions.tagDegree = filterDegree;
            }
            if (filterPrice !== "") {
              newConditions.tagPrice = filterPrice;
            }
            if (filterTime !== "") {
              newConditions.startTime = filterTime;
            }
            if (filterTaipei !== "") {
              newConditions.city = filterTaipei;
            }

            setConditions(newConditions);
            if (weekfilterDegree !== "") {
              newWeekConditions.tagDegree = weekfilterDegree;
            }
            if (weekfilterPrice !== "") {
              newWeekConditions.tagPrice = weekfilterPrice;
            }
            if (weekfilterTime !== "") {
              newWeekConditions.startTime = weekfilterTime;
            }
            setweekConditions(newWeekConditions);
          }, [
            filterDegree,
            weekfilterDegree,
            filterPrice,
            weekfilterPrice,
            filterTime,
            weekfilterTime,
          ]);

          const tagFilter = (id, value, name, time) => {
            if (time == "today") {
              //取得包本日tag的容器
              const filterBox = document.getElementById("today_allfilterBtn");
              const tagStyle = document.getElementById(id);

              if (tagStyle.classList == "active") {
                /* 如果已經選中=>移除class="active" */
                tagStyle.classList.remove("active");

                console.log("取消選取");
                switch (name) {
                  case "tagDegree":
                    setFilterDegree("");
                    break;
                  case "tagPrice":
                    setFilterPrice("");
                    break;
                  case "startTime":
                    setFilterTime("");
                    break;
                  case "city":
                    setFilterTaipei("");
                    break;

                    break;
                  default:
                    break;
                }
              } else {
                /* 如果沒有選中=>新增class="active" */
                tagStyle.classList.add("active");
                allBtn.classList.remove("active");
                console.log(tagStyle);
                switch (name) {
                  case "tagDegree":
                    setFilterDegree(`${value}`);
                    break;
                  case "tagPrice":
                    setFilterPrice(`${value}`);
                    break;
                  case "startTime":
                    setFilterTime(`${value}`);
                    break;
                  case "city":
                    setFilterTaipei(`${value}`);
                    break;

                    break;
                  default:
                    break;
                }
                console.log("本日類型: " + name);
                console.log("本日篩選 : " + value);
                filterPosts;
              }
              if (id == "tags-All") {
                //取得filterBox下所有的button
                const filterButtons = filterBox.querySelectorAll("button");
                filterButtons.forEach((button) => {
                  //移除所有button的active類
                  button.classList.remove("active");
                });
                setFilterDegree("");
                setFilterPrice("");
                setFilterTime("");
                setFilterTaipei("");
                setFilterXinpei("");
                if (allBtn.classList == "active") {
                  allBtn.classList.remove("active");
                } else {
                  allBtn.classList.add("active");
                }
              }
            } else if (time == "week") {
              //取得包本週tag的容器
              const weekfilterBox =
                document.getElementById("week_allfilterBtn");
              const week_tagStyle = document.getElementById(id);

              if (week_tagStyle.classList == "active") {
                /* 如果已經選中=>移除class="active" */
                week_tagStyle.classList.remove("active");

                console.log("取消選取");
                switch (name) {
                  case "tagDegree":
                    setweekFilterDegree("");
                    break;
                  case "tagPrice":
                    setweekFilterPrice("");
                    console.log("改變價格:" + weekfilterPrice);
                    break;
                  case "startTime":
                    setweekFilterTime("");
                    break;
                  case "city":
                    setweekFilterTaipei("");
                    break;
                  default:
                    break;
                }
              } else {
                /* 如果沒有選中=>新增class="active" */
                week_tagStyle.classList.add("active");
                week_allBtn.classList.remove("active");
                console.log(week_tagStyle);
                switch (name) {
                  case "tagDegree":
                    setweekFilterDegree(`${value}`);
                    break;
                  case "tagPrice":
                    setweekFilterPrice(`${value}`);
                    console.log("改變價格:" + weekfilterPrice);
                    break;
                  case "startTime":
                    setweekFilterTime(`${value}`);
                    break;
                  default:
                    break;
                }
                weekFilterPosts;
                console.log("本週類型: " + name);
                console.log("本週篩選 : " + value);
              }
              if (id == "tags-weekAll") {
                //取得filterBox下所有的button
                const weekfilterButtons =
                  weekfilterBox.querySelectorAll("button");
                weekfilterButtons.forEach((button) => {
                  //移除所有button的active類
                  button.classList.remove("active");
                });
                setweekFilterDegree("");
                setweekFilterPrice("");
                setweekFilterTime("");

                if (week_allBtn.classList == "active") {
                  week_allBtn.classList.remove("active");
                } else {
                  week_allBtn.classList.add("active");
                }
              }
            }
          };

          useEffect(() => {
            console.log("目前本日篩選: ", conditions);
            console.log("目前本週篩選: ", weekConditions);
          }, [conditions, weekConditions]);
          /* 篩選本日資料 */
          const filterPosts = useMemo(() => {
            // 沒有篩選時渲染全部貼文
            if (!filterDegree && !filterPrice && !filterTime) {
              return [...getPosts(todayType)];
            }
            return [...getPosts(todayType)].filter((posts) => {
              let matchAllConditions = true;
              for (const key in conditions) {
                if (
                  // newConditions.hasOwnProperty(key) &&
                  conditions[key] !== ""
                ) {
                  if (posts.hasOwnProperty(key)) {
                    switch (key) {
                      case "tagDegree":
                        matchAllConditions =
                          matchAllConditions &&
                          posts[key].includes(conditions[key]);
                        break;
                      case "tagPrice":
                        //比較價格小於條件值
                        matchAllConditions =
                          matchAllConditions &&
                          posts[key] <= parseInt(conditions[key]);
                        break;
                      case "startTime":
                        // 比較startTime 是否大于條件

                        matchAllConditions =
                          matchAllConditions &&
                          parseInt(posts[key].split(":")[0]) >= conditions[key];

                        break;
                      case "city":
                        matchAllConditions =
                          matchAllConditions &&
                          posts[key].match(conditions[key]);
                        break;
                      default:
                        // 未知屬性
                        matchAllConditions = false;
                        break;
                    }
                  } else {
                    //
                    matchAllConditions = false;

                    // 如果某个条件不匹配，则停止遍历并返回 false
                    if (!matchAllConditions) {
                      return false;
                    }
                  }
                }
              }
              // 如果所有条件都匹配，则返回 true
              return matchAllConditions;
            });
          }, [todayType, filterTag, tagDataType, conditions]);

          const weekFilterPosts = useMemo(() => {
            // 沒有篩選時渲染全部貼文
            if (!weekfilterDegree && !weekfilterPrice && !weekfilterTime) {
              return [...getPosts(weekType)];
            }

            return [...getPosts(weekType)].filter((posts) => {
              let matchAllConditions = true;
              for (const key in weekConditions) {
                if (weekConditions[key] !== "") {
                  if (posts.hasOwnProperty(key)) {
                    switch (key) {
                      case "tagDegree":
                        matchAllConditions =
                          matchAllConditions &&
                          posts[key].includes(weekConditions[key]);
                        break;
                      case "tagPrice":
                        // 比較價格小於條件值
                        matchAllConditions =
                          matchAllConditions &&
                          posts[key] <= parseInt(weekConditions[key]);
                        break;
                      case "startTime":
                        // 比較 startTime 是否
                        const startTime = parseInt(posts[key].split(":")[0]);
                        const conditionTime = parseInt(weekConditions[key]);
                        matchAllConditions =
                          matchAllConditions &&
                          startTime >= conditionTime &&
                          startTime < conditionTime + 4;
                        break;
                      default:
                        matchAllConditions = false;
                        break;
                    }
                  } else {
                    matchAllConditions = false;
                  }
                }

                // 如果某个条件不匹配，则停止遍历并返回 false
                if (!matchAllConditions) {
                  return false;
                }
              }
              // 如果所有条件都匹配，则返回 true
              return matchAllConditions;
            });
          }, [
            weekType,
            weekfilterDegree,
            weekfilterPrice,
            weekfilterTime,
            weekConditions,
          ]);

          const [showNotice, setShowNotice] = useState(false);
          const handleNotice = () => {
            setShowNotice(true);
          };

          /* 拖拽輪播 */
          // 今日
          const [dragStartX, setDragStartX] = useState(0);
          const [dragging, setDragging] = useState(false);
          const [containerRef, setContainerRef] = useState(null);

          const handleDragStart = (event) => {
            setDragging(true);
            setDragStartX(event.clientX);
          };

          const handleDragMove = (event) => {
            if (!dragging || !containerRef) return;
            const delta = event.clientX - dragStartX;
            containerRef.scrollLeft -= delta;
            setDragStartX(event.clientX);
          };

          const handleDragEnd = () => {
            setDragging(false);
          };

          // 本周
          const [week_dragStartX, setWeekDragStartX] = useState(0);
          const [week_dragging, setWeekDragging] = useState(false);
          const [week_containerRef, setWeekContainerRef] = useState(null);

          const weekHandleDragStart = (event) => {
            setWeekDragging(true);
            setWeekDragStartX(event.clientX);
          };

          const weekHandleDragMove = (event) => {
            if (!week_dragging || !week_containerRef) return;
            const delta = event.clientX - week_dragStartX;
            week_containerRef.scrollLeft -= delta;
            setWeekDragStartX(event.clientX);
          };

          const weekHandleDragEnd = (event) => {
            event.stopPropagation(); //阻止事件冒泡，就不會影響到貼文元件的按鈕事件
            setWeekDragging(false);
          };

          /* 篩選表單更新選項 */
          const [selectedCity, setSelectedCity] = useState("全部");
          const [areaOption, setAreaOption] = useState(["地區"]);
          const [showArea, setShoeArea] = useState("none");
          let selectCity = document.getElementById("city");
          let selectArea = document.getElementById("selectArea");
          const changeArea = (value) => {
            setSelectedCity(value);
            var options = {
              taipei: [
                "中正區",
                "大同區",
                "中山區",
                "松山區",
                "大安區",
                "萬華區",
                "信義區",
                "士林區",
                "北投區",
                "內湖區",
                "南港區",
                "文山區",
              ],
              xinpei: [
                "板橋區",
                "新莊區",
                "中和區",
                "永和區",
                "土城區",
                "樹林區",
                "三重區",
                "新店區",
                "淡水區",
                "汐止區",
                "瑞芳區",
                "八里區",
                "林口區",
                "芦洲區",
                "五股區",
                "泰山區",
                "三峽區",
                "鶯歌區",
                "石碇區",
                "深坑區",
                "石門區",
                "坪林區",
                "平溪區",
                "雙溪區",
                "貢寮區",
                "金山區",
                "萬里區",
                "烏來區",
              ],
              counties: [
                "基隆市",
                "新竹市",
                "桃園市",
                "臺中市",
                "臺南市",
                "高雄市",
                "嘉義市",
                "新竹縣",
                "苗栗縣",
                "彰化縣",
                "南投縣",
                "雲林縣",
                "嘉義縣",
                "屏東縣",
                "宜蘭縣",
                "花蓮縣",
                "臺東縣",
                "澎湖縣",
              ],
            };
            if (value == "台北市") {
              selectArea;
              setAreaOption(options.taipei);
              setShoeArea("flex");
            } else if (value == "新北市") {
              setAreaOption(options.xinpei);
              setShoeArea("flex");
            } else if (value == "其他") {
              setAreaOption(options.counties);
              setShoeArea("flex");
            } else {
              setShoeArea("none");
            }
          };

          /* 儲存篩選條件 */
          const [selectedDate, setSelectedDate] = useState("全部"); //日期
          const [selectedArea, setSelectedArea] = useState([]); //地區
          const [selectedCost, setSelectedCost] = useState("全部"); //費用
          const [selectedDegree, setSelectedDegree] = useState("全部"); //程度
          const [selectedRol, setSelectedRol] = useState("全部"); //排球類型
          const [selectedEquip, setSelectedEquip] = useState(["全部"]); //羽球設備

          const handleSelectChange = (event) => {
            //转换为数组，并提取每个选项的值。
            const selectedOptions = Array.from(
              event.target.selectedOptions,
              (option) => option.value
            );
            setSelectedArea(selectedOptions);
          };

          const SaveData = () => {
            window.localStorage.filterDate = selectedDate;
            window.localStorage.filterCity = selectedCity;
            localStorage.setItem('filterArea', JSON.stringify(selectedArea));
            window.localStorage.filterCost = selectedCost;
            window.localStorage.filterDegree = selectedDegree;
            window.localStorage.filterRol = selectedRol;
            window.localStorage.filterEquip = selectedEquip;
            //
            window.localStorage.filterType = filterTag;
            };
          useEffect(() => {
            console.log(selectedArea);
            console.log("程度: " + selectedDegree);
          }, [selectedArea, selectedDegree]);

          // 元件
          /* 建立元件 header元件 */
          const TopBar = ({ mobileTopBar }) => {
            return (
              <>
                <div className="mobile-TopBar">
                  <img src={mobileTopBar} alt="" />
                </div>
                <header id="topBar">
                  <nav id="top-nav">
                    <ul id="menu">
                      <li>
                        <a href="./index.html">
                          <img
                            className="icon"
                            src="./images/magnifier.png"
                            alt=""
                          />
                          探索
                        </a>
                      </li>
                      <li>
                        <a href="./publicationForm.html">
                          <img
                            className="icon"
                            src="./images/post.png"
                            alt=""
                          />
                          找人
                        </a>
                      </li>
                      <li>
                        <a href="notice.html">
                          <img
                            className="icon"
                            src="./images/bell3.png"
                            alt=""
                          />
                          行程
                        </a>
                      </li>
                      <li>
                        <a href="personal.html">
                          <img className="icon" src="./images/cat.png" alt="" />
                          個人
                        </a>
                      </li>
                    </ul>
                  </nav>
                  <div className="form-title">
                    <div className="hugTitle noto-sans-tc">
                      <img src="./images/vbtitle.svg" alt="" />
                      <h1 className="title-L" value="我的行程">
                        我的行程
                      </h1>
                      <img src="./images/bmtitle.svg" alt="" />
                    </div>
                    <a href="./myCollect.html" className="button btn-postManage">
                      我的收藏
                      <img src="./images/heart-yes.svg" alt="" />
                    </a>
                  </div>
                </header>
              </>
            );
          };
          // 建立貼文元件
          const PostCard = ({
            id,
            type,
            postDate,
            postStartTime,
            postEndTime,
            postCity,
            postArea,
            postArena,
            primaryTag,
            secondaryTag,
            reqCount,
            role,
            pos,
            equip,
            note,
            href,
            host,
            ballBrand,
          }) => {
            return (
              <>
                <div
                  className="content"
                  id={id}
                  style={{ backgroundImage: postBorder }}
                >
                  <div className="text">
                    <div className="mainText">
                      <p className="text-M">{postDate}</p>
                      <p className="text-L">{postStartTime}</p>
                    </div>
                    <div className="subtext">
                      <p className="text-S">{postCity}</p>
                      <p className="text-S">{postArea}</p>
                    </div>
                    <h3 className="text-L" value={`${postArena}`}>
                      {postArena}
                    </h3>
                    <div className="tag-style">
                      <p className="text-S tagMargin">{primaryTag}</p>
                      <p className="text-S tagMargin">${secondaryTag}</p>
                    </div>
                    <div className="BtnContainer">
                      <a
                        className="button"
                        href={`#${href}`}
                        onMouseDown={(e) => e.stopPropagation()}
                      >
                        {/* onMouseDown={(e) => e.stopPropagation()}為了阻止冒泡 使其不會跟托拽輪播衝突 */}
                        報名
                      </a>
                    </div>
                  </div>
                </div>

                <ApplyCard
                  href={href}
                  type={type}
                  postDate={postDate}
                  postStartTime={postStartTime}
                  postEndTime={postEndTime}
                  postCity={postCity}
                  postArea={postArea}
                  postArena={postArena}
                  primaryTag={primaryTag}
                  secondaryTag={secondaryTag}
                  female={reqCount[0].count}
                  male={reqCount[1].count}
                  unspecified={reqCount[2].count}
                  role={role}
                  equip={equip}
                  pos={pos}
                  note={note}
                  host={host}
                  ballBrand={ballBrand}
                  noticeHref={`${href}-noticeApplyPopUp-${id}`}
                />
              </>
            );
          };
          //建立貼文報名元件
          const ApplyCard = ({
            href,
            type,
            postDate,
            postStartTime,
            postEndTime,
            postCity,
            postArea,
            postArena,
            primaryTag,
            secondaryTag,
            female,
            male,
            unspecified,
            role,
            pos,
            equip,
            ballBrand,
            note,
            host,

            noticeHref,
          }) => {
            const [showBallBrand, setShowBallBrand] = useState("none");
            const [showVbInfo, setShowVbInfo] = useState("flex");
            useEffect(() => {
              if (type == "羽球") {
                hostType = "bm";
                setShowBallBrand("flex");
                setShowVbInfo("none");
              }
            }, [type]);
            var hostType = "vb";
            if (type == "羽球") {
              hostType = "bm";
            }
            return (
              <>
                <div
                  className="popup"
                  id={href}
                  onMouseDown={(e) => e.stopPropagation()}
                >
                  <div className="popup-inner">
                    <div className="popup__content">
                      <div className="detailPostInfo">
                        <div className="simplePostInfo">
                          <div className="main-info">
                            <div className="header">
                              <p>
                                {postDate} {postStartTime}~{postEndTime}
                              </p>
                              <div className="type-style">{type}</div>
                              <button className="collect">
                                <img src="./images/heart-no.svg" alt="收藏" />
                              </button>
                            </div>
                            <div className="areaInfo">
                              <h3>{postCity}</h3>
                              <h3>{postArea}</h3> <h3>{postArena}</h3>
                            </div>
                            <div className="tag-style">
                              <p>{primaryTag}</p>
                              <p>${secondaryTag}</p>
                            </div>
                          </div>
                          <div className="sub-info">
                            <div className="vacancyInfo">
                              <h4>缺額</h4>
                              <div>女</div>
                              <p>{female}位</p>
                              <div>男</div>
                              <p>{male}位</p>
                              <div>不限</div> <p>{unspecified}位</p>
                            </div>
                            <div
                              className="ballInfo"
                              style={{ display: showVbInfo }}
                            >
                              <h4>類型</h4>
                              <p>{role}</p>
                            </div>
                            <div
                              className="ballInfo"
                              style={{ display: showBallBrand }}
                            >
                              <h4>用球</h4>
                              <p>{ballBrand}</p>
                            </div>
                            <div
                              className="equipInfo"
                              style={{ display: showVbInfo }}
                            >
                              <h4>位置</h4>
                              <p>{pos}</p>
                            </div>
                            <div
                              className="equipInfo"
                              style={{ display: showBallBrand }}
                            >
                              <h4>設備</h4>
                              <p>{equip}</p>
                            </div>
                            <div className="noteInfo">
                              <h4>備註</h4>
                              <p>{note}</p>
                            </div>
                          </div>

                          <div className="apply-info">
                            <hr />
                            <img
                              src={`./images/host-${hostType}.png`}
                              alt="團主頭貼"
                            />
                            <p>
                              團主<span>{host}</span>
                            </p>
                            <div className="component-writeBlock">
                              <p>報名備註 : </p>
                              <input
                                type="text"
                                placeholder="輸入對團主的話..."
                              />
                            </div>
                          </div>

                          <div className="BtnContainer">
                            <a className="btn-close popup__close" href="#">
                              關閉
                            </a>
                            <a href={`#${noticeHref}`}>
                              <button className="button" onClick={handleNotice}>
                                確認報名
                              </button>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                {showNotice && <NoticeApply noticeHref={noticeHref} />}
              </>
            );
          };
          //建立通知報名元件
          const NoticeApply = ({ noticeHref }) => {
            return (
              /*燈箱效果-報名審核中通知 */
              <div
                className="popup"
                id={noticeHref}
                onMouseDown={(e) => e.stopPropagation()}
              >
                <div className="popup-static">
                  <div className="popup__content">
                    {/* 報名審核中通知元件 */}
                    <div className="notice-apply">
                      <p>已送出報名，團主審核中</p>
                      <a className="popup__close" href="#">
                        <img src="../images/cancel.png" alt="關閉按鈕" />
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            );
          };
          //建立篩選表單元件
          const FilterForm = ({ areaOption }) => {
            return <></>;
          };
          
          const Option = ({ option }) => {
            return (
              <>
                <option value={option}>{option}</option>
              </>
            );
          };
          return (
            <div className="body">
              <TopBar mobileTopBar={mobileTopBar} />
              <main className="index-Area">
                {/*篩選區 */}
                <section className="search">
                  <div className="btn-changeType">
                    <div className="form-type">
                      <button
                        id="btn-formBM"
                        // ref={btnFormBmRef}
                        className={
                          selectedButton === "btn-typeBm" ? "selected" : ""
                        }
                        onClick={() => changeType("btn-typeBm")}
                      >
                        打羽球
                      </button>

                      <button
                        id="btn-formVB"
                        // ref={btnFormVbRef}
                        className={
                          selectedButton === "btn-typeVb" ? "selected" : ""
                        }
                        onClick={() => changeType("btn-typeVb")}
                      >
                        打排球
                      </button>
                    </div>
                  </div>
                  <div id="search-Type">
                    <button
                      id="btn-typeVb"
                      className={
                        selectedButton === "btn-typeVb" ? "selected" : ""
                      }
                      ref={btnTypeVbRef}
                      onClick={() => changeType("btn-typeVb")}
                    ></button>
                    <button
                      id="btn-typeBm"
                      className={
                        selectedButton === "btn-typeBm" ? "selected" : ""
                      }
                      onClick={() => changeType("btn-typeBm")}
                      ref={btnTypeBmRef}
                    ></button>
                  </div>
                  <div id="search-Bar" style={{ backgroundColor: mainColor }}>
                    <div className="dropMenu">
                      <ul>
                        <input
                          className="dpMenu-item"
                          type="date"
                          name="日期"
                          id="date"
                          title="打球日"
                          required
                          onChange={(e) => {
                            setSelectedDate(e.target.value);
                          }}
                        />
                        <select
                          name="縣市"
                          id="city"
                          className="dpMenu-item"
                          onChange={(e) => {
                            changeArea(e.target.value);
                          }}
                        >
                          <option value="default">縣市</option>
                          <option value="台北市">台北市</option>
                          <option value="新北市">新北市</option>
                          <option value="其他">其他</option>
                        </select>
                        <select
                          name="地區"
                          multiple
                          id="selectArea"
                          className="dpMenu-item"
                          style={{ display: showArea }}
                          onChange={(e) => {
                            handleSelectChange(e);
                          }}
                        >
                          {areaOption.map((option, index) => {
                            return (
                              <Option key={index} option={option}></Option>
                            );
                          })}
                        </select>
                        <select
                          name="程度"
                          id="degree"
                          className="dpMenu-item"
                          style={{ display: VBdisplay }}
                          onChange={(e) => {
                            setSelectedDegree(e.target.value);
                          }}
                        >
                          <option value="default">程度</option>
                          <option value="C">C</option>
                          <option value="B">B</option>
                          <option value="A">A</option>
                          <option value="S">S</option>
                        </select>
                        <select
                          name="程度"
                          id="degree"
                          className="dpMenu-item"
                          style={{ display: BMdisplay }}
                          onChange={(e) => {
                            setSelectedDegree(e.target.value);
                          }}
                        >
                          <option value="default">程度</option>
                          <option value="新手">新手</option>
                          <option value="初階">初階</option>
                          <option value="初上"> 初上</option>
                          <option value="中下">中下</option>
                          <option value="中階">中階</option>
                          <option value="中上">中上</option>
                          <option value="中進階">中進階</option>
                        </select>

                        <select
                          name="費用"
                          id="cost"
                          className="dpMenu-item"
                          onChange={(e) => {
                            setSelectedCost(e.target.value);
                          }}
                        >
                          <option value="default">費用</option>
                          <option value="150">150以下</option>
                          <option value="200">200以下</option>
                          <option value="250">250以下</option>
                        </select>
                        <select
                          name="類型"
                          id="type"
                          className="dpMenu-item"
                          style={{ display: VBdisplay }}
                          onChange={(e) => {
                            setSelectedRol(e.target.value);
                          }}
                        >
                          <option value="default">類型</option>
                          <option value="男網純男">男網純男</option>
                          <option value="女網純女">女網純女</option>
                          <option value="男網混排">男網混排</option>
                          <option value="女網混排">女網混排</option>
                        </select>
                        <select
                          name="設備"
                          id="equip"
                          className="dpMenu-item"
                          style={{ display: BMdisplay }}
                          onChange={(e) => {
                            setSelectedEquip(e.target.value);
                          }}
                        >
                          <option value="default">設備</option>
                          <option value="側燈">側燈</option>
                          <option value="冷氣">冷氣</option>
                          <option value="飲水機">飲水機</option>
                          <option value="停車場">停車場</option>
                          <option value="PVC地板">PVC地板</option>
                          <option value="淋浴">淋浴</option>
                        </select>
                      </ul>
                      {/**/}
                    </div>
                    <div className="searchBtn-box">
                      <div id="search-Type">
                        <button
                          id="btn-typeVb"
                          className={
                            selectedButton === "btn-typeVb" ? "selected" : ""
                          }
                          ref={btnTypeVbRef}
                          onClick={() => changeType("btn-typeVb")}
                        ></button>
                        <button
                          id="btn-typeBm"
                          className={
                            selectedButton === "btn-typeBm" ? "selected" : ""
                          }
                          onClick={() => changeType("btn-typeBm")}
                          ref={btnTypeBmRef}
                        ></button>
                      </div>
                      <a href="./filterPosts.html">
                        <button
                          type="submit"
                          className="btn-send button"
                          onClick={() => {
                            SaveData();
                          }}
                        >
                          送出
                        </button>
                      </a>
                    </div>
                  </div>
                </section>
                {/* 本日臨打貼文 */}
                <section className="post-containers">
                  <div className="title-postArea">
                    <h2>
                      <div className="titleLine"></div>
                      本日臨打貼文
                    </h2>
                    <a href={hrefTodayMore}>
                      <div className="more button">更多</div>
                    </a>
                  </div>
                  <ul className="tags" id="today_allfilterBtn">
                    <button
                      id="tags-All"
                      className="active"
                      onClick={() =>
                        tagFilter("tags-All", "排球", "type", "today")
                      }
                    >
                      全部
                    </button>
                    <button
                      id="tags-B"
                      onClick={() =>
                        tagFilter("tags-B", degreeTag, "tagDegree", "today")
                      }
                    >
                      {degreeTag}
                    </button>
                    <button
                      id="tags-200"
                      onClick={() =>
                        tagFilter("tags-200", "200", "tagPrice", "today")
                      }
                    >
                      $200↓
                    </button>
                    <button
                      id="tags-night"
                      onClick={() =>
                        tagFilter("tags-night", "18", "startTime", "today")
                      }
                    >
                      晚上
                    </button>
                  </ul>
                  <div
                    className="post-block"
                    ref={(ref) => setContainerRef(ref)}
                    onMouseDown={handleDragStart}
                    onMouseMove={handleDragMove}
                    onMouseUp={handleDragEnd}
                    onMouseLeave={handleDragEnd}
                    onTouchStart={handleDragStart}
                    onTouchMove={handleDragMove}
                    onTouchEnd={handleDragEnd}
                  >
                    {/* <Slider {...settings}> */}
                    {filterPosts.map((post_data) => {
                      return (
                        <PostCard
                          key={post_data.id}
                          id={post_data.id}
                          type={post_data.type}
                          postDate={post_data.date}
                          postStartTime={post_data.startTime}
                          postEndTime={post_data.endTime}
                          postCity={post_data.city}
                          postArea={post_data.area}
                          postArena={post_data.arena}
                          primaryTag={post_data.tagDegree}
                          secondaryTag={post_data.tagPrice}
                          reqCount={post_data.reqCount}
                          role={post_data.role}
                          pos={post_data.pos}
                          note={post_data.note}
                          href={`todayApplyPopUp-${post_data.id}`}
                          host={post_data.host}
                          ballBrand={post_data.ballBrand}
                          equip={post_data.equip}
                          like={post_data.like}
                        />
                      );
                    })}
                    {/* </Slider> */}
                  </div>
                </section>
                {/* 本週臨打貼文 */}
                <section className="post-containers">
                  <div className="title-postArea">
                    <h2>
                      <div className="titleLine"></div>本週臨打貼文
                    </h2>
                    <a href={hrefWeekMore}>
                      <div className="more button">更多</div>
                    </a>
                  </div>
                  <ul className="tags" id="week_allfilterBtn">
                    <button
                      id="tags-weekAll"
                      className="active"
                      onClick={() =>
                        tagFilter("tags-weekAll", "排球", "type", "week")
                      }
                    >
                      全部
                    </button>
                    <button
                      id="tags-weekB"
                      onClick={() =>
                        tagFilter("tags-weekB", degreeTag, "tagDegree", "week")
                      }
                    >
                      {degreeTag}
                    </button>
                    <button
                      id="tags-week200"
                      onClick={() =>
                        tagFilter("tags-week200", "200", "tagPrice", "week")
                      }
                    >
                      $200↓
                    </button>
                    <button
                      id="tags-weeknight"
                      onClick={() =>
                        tagFilter("tags-weeknight", "18", "startTime", "week")
                      }
                    >
                      晚上
                    </button>
                  </ul>
                  <div
                    className="post-block"
                    ref={(ref) => setWeekContainerRef(ref)}
                    onMouseDown={weekHandleDragStart}
                    onMouseMove={weekHandleDragMove}
                    onMouseUp={weekHandleDragEnd}
                    onMouseLeave={weekHandleDragEnd}
                    onTouchStart={weekHandleDragStart}
                    onTouchMove={weekHandleDragMove}
                    onTouchEnd={weekHandleDragEnd}
                  >
                    {weekFilterPosts.map((post_data) => {
                      return (
                        <PostCard
                          key={post_data.id}
                          id={post_data.id}
                          type={post_data.type}
                          postDate={post_data.date}
                          postStartTime={post_data.startTime}
                          postEndTime={post_data.endTime}
                          postCity={post_data.city}
                          postArea={post_data.area}
                          postArena={post_data.arena}
                          primaryTag={post_data.tagDegree}
                          secondaryTag={post_data.tagPrice}
                          reqCount={post_data.reqCount}
                          role={post_data.role}
                          pos={post_data.pos}
                          note={post_data.note}
                          href={`weekApplyPopUp-${post_data.id}`}
                          host={post_data.host}
                          ballBrand={post_data.ballBrand}
                          equip={post_data.equip}
                          like={post_data.like}
                        />
                      );
                    })}
                  </div>
                </section>
              </main>
              <Footer />
            </div>
          );
        };
        ReactDOM.createRoot(document.getElementById("root")).render(<App />);
      })();
    </script>
  </body>
</html>
