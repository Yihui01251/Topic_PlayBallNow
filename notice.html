<!DOCTYPE html>
<html lang="zh-Hant-TW">
  <head>
    <title>行程</title>
    <link rel="stylesheet" href="./stylesheets/css/style-scss.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="UTF-8" />
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/redux/4.2.0/redux.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
      .fileName {
        display: none;
      }
    </style>
  </head>
  <body id="body">
    <small class="fileName">檔名：<code>notice.html</code></small>
    <!-- 根元素  -->
    <div id="root"></div>
    <script type="text/babel">
      (async () => {
        //取得json資料
        const data = await axios.get("./userData.json");
        const { userData } = data.data;
        console.log(userData);
        const { past_ALL_userData } = userData[0];
        const { past_appl_userData } = userData[5];
        const { future_All_userData } = userData[1];
        const { future_cancel_userData } = userData[2];
        const { future_host_userData } = userData[3];
        const { future_appl_userData } = userData[4];

        const { useState, useEffect, useRef, useMemo } = React;

        const Notify = ({
          name,
          day,
          startTime,
          endTime,
          type,
          city,
          area,
          arena,
          tagDegree,
          tagPrice,
          state,
          identity,
          id,
          role,
          female,
          male,
          unspecified,
          equip,
          note,
          like,
          ballBrand,
          appl = [], //確保為陣列，默認為空
          cancel,
        }) => {
          /* 主色 */
          const [typeStyle, setTypeStyle] = useState("");
          /* 文字色 */
          const [typeFontStyle, setTypeFontStyle] = useState("");
          /* 狀態色 */
          const [stateStyle, setStateStyle] = useState("");
          /* 邊框樣式 */
          const [identityStyle, setIdentityStyle] = useState("3px solid black");
          /* 出席率圖 */
          const [ellipseBar, setEllipseBar] = useState("");
          /* 呼叫燈箱元件連結 */
          const [popupHref, setPopupHref] = useState("");
          /* 顯示報名列 */
          const [showApplicants, setShowApplicants] = useState("");
          /* 顯示取消列 */
          const [showCancel, setShowCancel] = useState("");
          /* 元件副資訊 */
          const [showBallBrand, setShowBallBrand] = useState("");
          const [showVbInfo, setShowVbInfo] = useState("");
          /* 狀態 */
          const [newNotifyState, setNewNotifyState] = useState("");

          useEffect(() => {
            // 保存最新的 identity 值
            const currentIdentity = identity;
            // 身分樣式
            // console.log("身分: " + currentIdentity);
            let borderStyle = "";
            let newHref = "";

            if (identity === "團主") {
              borderStyle = "3px dashed black";
              setShowApplicants("flex");
              setShowCancel("none");
              if (name === "所有過去貼文") {
                newHref = "evaluateApplyPopup";
              } else {
                newHref = "auditApplyPopup";
              }
            } else if (identity === "臨打") {
              borderStyle = "3px solid black";
              setShowApplicants("none");
              setShowCancel("flex");
              if (name === "所有過去貼文") {
                newHref = "evaluateSponsorPopup";
              } else {
                newHref = "auditApplyPopup";
              }

              if (name === "所有未來取消貼文") {
                setShowApplicants("none");
                setShowCancel("none");
              }
            }
            setIdentityStyle(borderStyle);
            document.documentElement.style.setProperty(
              "--border-type",
              borderStyle
            );
            setPopupHref(newHref);
            // console.log("目前連結" + popupHref);
            // 羽or排顏色
            let typeStyle = "";
            let typeFontStyle = "";
            let stateColor = "";
            let ellipseBar = "";
            if (type === "羽") {
              typeStyle = "rgba(131, 185, 15, 0.9)";
              typeFontStyle = "#689607";
              ellipseBar = "/images/ellipsebarbm.png";
              //副資訊
              setShowBallBrand("flex");
              setShowVbInfo("none");
            } else if (type === "排") {
              typeStyle = "#14AAEB";
              typeFontStyle = "#147CB6";
              ellipseBar = "/images/ellipsebarvb.png";
              //副資訊
              setShowBallBrand("none");
              setShowVbInfo("flex");
            }
            setTypeFontStyle(typeFontStyle);
            setTypeStyle(typeStyle);
            setEllipseBar(ellipseBar);
            // document.documentElement.style.setProperty(
            //   "--font-color",
            //   typeFontStyle
            // );
            // document.documentElement.style.setProperty(
            //   "--main-color",
            //   typeStyle
            // );

            // 狀態顏色
            switch (state) {
              case "報名成功":
                return setStateStyle("#1A8D07"), setNewNotifyState(state);
              case "報名失敗":
                return setStateStyle("#777777"), setNewNotifyState(state);
              case "候補中":
                return setStateStyle("#2D2AE6"), setNewNotifyState(state);
              case "已取消":
                return setStateStyle("#777777"), setNewNotifyState(state);
              case "申請中":
                return setStateStyle("#FF4F03"), setNewNotifyState(state);
              case "未評價":
                return setStateStyle("#FF4F03"), setNewNotifyState(state);
              case "取消ing":
                return setStateStyle("#FF4F03"), setNewNotifyState(state);
              case "已評價":
                return setStateStyle("#1a8d07"), setNewNotifyState(state);
              default:
                setNewNotifyState(state);
                break;
            }

            document.getElementsByClassName("notice-container");
          }, [type, state, identity, popupHref, name, setNewNotifyState]);

          /* 查看貼文元件 */
          const [detailNotify, setDetailNotify] = useState(false);
          /* 臨打評價元件 */
          const [applicantEvaluateCard, setApplicantEvaluateCard] =
            useState(false);
          /* 團主評價元件 */
          const [sponsorEvaluateCard, setSponsorEvaluateCard] = useState(false);
          /* 是否呼叫元件 */
          const establishDetailNotify = (href) => {
            {
              if (href === "auditApplyPopup") {
                setDetailNotify(true);
                setApplicantEvaluateCard(false);
                setSponsorEvaluateCard(false);
              } else if (href === "evaluateApplyPopup") {
                setDetailNotify(false);
                setApplicantEvaluateCard(false);
                setSponsorEvaluateCard(true);
              } else {
                setDetailNotify(false);
                setApplicantEvaluateCard(true);
                setSponsorEvaluateCard(false);
              }
            }
          };

          return (
            <>
              <a
                className="container-component"
                href={`#${popupHref}-${id}`}
                onClick={() => establishDetailNotify(popupHref)}
              >
                <div
                  className={"notice-container hoverNotice"}
                  style={{ color: typeFontStyle, border: identityStyle }}
                >
                  <div
                    className="notice-ballType"
                    style={{ backgroundColor: typeStyle }}
                  >
                    <p>{type}</p>
                  </div>
                  <div className="notice-info">
                    <div>
                      <p>
                        {day} {startTime}
                      </p>
                    </div>
                    <p>{arena}</p>
                    <div
                      style={{
                        color: stateStyle,
                        border: "1px solid",
                        stateStyle,
                      }}
                    >
                      <p>{newNotifyState}</p>
                    </div>
                  </div>
                </div>
              </a>
              {detailNotify && (
                <DetailPostCard
                  day={day}
                  startTime={startTime}
                  endTime={endTime}
                  type={type}
                  city={city}
                  area={area}
                  arena={arena}
                  tagDegree={tagDegree}
                  tagPrice={tagPrice}
                  state={state}
                  id={id}
                  female={female}
                  male={male}
                  unspecified={unspecified}
                  role={role}
                  equip={equip}
                  ballBrand={ballBrand}
                  note={note}
                  appl={appl}
                  cancel={cancel}
                  popUp={popupHref}
                  typeStyle={typeStyle}
                  typeFontStyle={typeFontStyle}
                  showApplicants={showApplicants}
                  showCancel={showCancel}
                  ellipseBar={ellipseBar}
                  showBmInfo={showBallBrand}
                  showVbInfo={showVbInfo}
                />
              )}
              {applicantEvaluateCard && (
                <EvaluateSponsorCard
                  day={day}
                  startTime={startTime}
                  endTime={endTime}
                  type={type}
                  city={city}
                  area={area}
                  arena={arena}
                  tagDegree={tagDegree}
                  tagPrice={tagPrice}
                  id={id}
                  state={state}
                  typeStyle={typeStyle}
                  typeFontStyle={typeFontStyle}
                  popUp={popupHref}
                  setNewNotifyState={setNewNotifyState}
                  setStateStyle={setStateStyle}
                />
              )}
              {sponsorEvaluateCard && (
                <EvaluateApplicantsCard
                  day={day}
                  startTime={startTime}
                  endTime={endTime}
                  type={type}
                  city={city}
                  area={area}
                  arena={arena}
                  tagDegree={tagDegree}
                  tagPrice={tagPrice}
                  appl={appl}
                  id={id}
                  state={state}
                  typeStyle={typeStyle}
                  typeFontStyle={typeFontStyle}
                  ellipseBarType={ellipseBar}
                  popUp={popupHref}
                />
              )}
            </>
          );
        };

        /* 建立元件 燈箱效果- 查看行程*/
        const DetailPostCard = ({
          day,
          startTime,
          endTime,
          type,
          city,
          area,
          arena,
          tagDegree,
          tagPrice,
          state,
          identity,
          id,
          female,
          male,
          unspecified,
          role,
          equip,
          ballBrand,
          note,
          appl,
          cancel,
          popUp,
          typeStyle,
          typeFontStyle,
          showApplicants,
          showCancel,
          showBmInfo,
          showVbInfo,
          ellipseBar,
        }) => {
          const [popupState, setPopupState] = useState({});
          //傳入id使其能對應元件
          const handlePopup = (popupId) => {
            //將useState設定成之前狀態(prevState)的相反
            setPopupState((prevState) => ({
              ...prevState,
              [popupId]: !prevState[popupId],
            }));
          };
          /* 是否生成審核取消元件 */
          const [auditCancelCard, setAuditCancelCard] = useState(false);
          const handleAuditCancelCard = () => {
            setAuditCancelCard(true);
          };
          /* 是否生成查看行程元件 */
          const [detailsNotifyCard, setDetailsNotifyCard] = useState(false);
          const handleDetailsNotifyCard = () => {
            setDetailsNotifyCard(true);
          };
          /* 是否生成審核報名元件 */
          const [auditApplyCard, setAuditApplyCard] = useState("");
          const [isNew, setIsNew] = useState("block");
          const [popupId, setPopupId] = useState("");
          const handleAuditApplyCard = (type, index) => {
            setIsNew("none");
            setAuditApplyCard(type);
            setPopupId(`${index}`);
            console.log(type);
          };
          /* 申請者元件 */
          const ApplicantsCard = ({ appl, id, index }) => {
            return (
              <>
                <a
                  href={`#detailApplyPopup-${id}-${index}`}
                  onClick={() => {
                    handleAuditApplyCard("apply", index);
                  }}
                >
                  <img
                    className="img-border"
                    src="../images/player.png"
                    alt=""
                  />
                  <div className="notice-new" style={{ display: isNew }}>
                    New
                  </div>
                </a>
              </>
            );
          };
          return (
            <>
              <div className="popup" id={`auditApplyPopup-${id}`}>
                <div className="popup-inner">
                  <div className="popup__content">
                    <div className="detailItinerary">
                      <div className="simplePostInfo">
                        <div className="main-info">
                          <div
                            className="header"
                            style={{ color: typeFontStyle }}
                          >
                            <p>
                              {day} {startTime}~{endTime}
                            </p>
                            <div
                              className="type-style"
                              style={{ backgroundColor: typeStyle }}
                            >
                              {type}球
                            </div>
                            <a className="popup__close" href="#">
                              <img src="../images/cancel.png" alt="" />
                            </a>
                          </div>
                          <div
                            className="areaInfo"
                            style={{ color: typeFontStyle }}
                          >
                            <h3>{city}</h3>
                            <h3>{area}</h3>
                            <h3>{arena}</h3>
                          </div>
                          <div className="tag-style">
                            <p
                              style={{
                                backgroundColor: typeFontStyle,
                                borderColor: typeFontStyle,
                              }}
                            >
                              {tagDegree}
                            </p>
                            <p
                              style={{
                                backgroundColor: typeFontStyle,
                                borderColor: typeFontStyle,
                              }}
                            >
                              ${tagPrice}
                            </p>
                          </div>
                        </div>
                        <div className="sub-info">
                          <div className="vacancyInfo">
                            <h4>缺額</h4>
                            <div>女</div>
                            <p style={{ color: typeFontStyle }}>{female}位</p>
                            <div>男</div>
                            <p style={{ color: typeFontStyle }}>{male}位</p>
                            <div>不限</div>
                            <p style={{ color: typeFontStyle }}>
                              {unspecified}位
                            </p>
                          </div>
                          <div
                            className="ballInfo"
                            style={{ display: showVbInfo }}
                          >
                            <h4>類型</h4>
                            <p style={{ color: typeFontStyle }}>{role}</p>
                          </div>
                          <div
                            className="equipInfo"
                            style={{ display: showVbInfo }}
                          >
                            <h4>位置</h4>
                            <p style={{ color: typeFontStyle }}>{equip}</p>
                          </div>
                          <div
                            className="ballInfo"
                            style={{ display: showBmInfo }}
                          >
                            <h4>用球</h4>
                            <p style={{ color: typeFontStyle }}>{ballBrand}</p>
                          </div>
                          <div
                            className="equipInfo"
                            style={{ display: showBmInfo }}
                          >
                            <h4>設備</h4>
                            <p style={{ color: typeFontStyle }}>{equip}</p>
                          </div>
                          <div className="noteInfo">
                            <h4>備註</h4>
                            <p style={{ color: typeFontStyle }}>{note}</p>
                          </div>
                        </div>

                        <div
                          className="auditList"
                          style={{ display: showApplicants }}
                        >
                          <div className="sponsored-title">
                            <div className="line-hugTitle">
                              <div className="titleLine"></div>
                              <h3>球友申請列表</h3>
                              <small> (已徵{state})</small>
                            </div>
                            <div className="titleArrowBtn">
                              <button>
                                <img
                                  src="../images/btn-left.png"
                                  alt="前一個"
                                />
                              </button>
                              <button>
                                <img
                                  src="../images/btn-right.png"
                                  alt="後一個"
                                />
                              </button>
                            </div>
                          </div>
                          <div className="applicant-container">
                            {appl.map((apply, index) => (
                              <ApplicantsCard
                                key={index}
                                appl={apply}
                                id={id}
                                index={index}
                              />
                            ))}

                            <a
                              href={`#detailApplyPopup-yes-0`}
                              onClick={() => handleAuditApplyCard("yes")}
                            >
                              <img
                                className="img-border"
                                src="../images/player-agree.png"
                                alt=""
                              />
                            </a>
                          </div>
                        </div>

                        <div
                          className="auditList"
                          style={{ display: showApplicants }}
                        >
                          <div className="sponsored-title">
                            <div className="line-hugTitle">
                              <div className="titleLine"></div>
                              <h3>取消申請列表</h3>
                            </div>
                          </div>
                          <div className="applicant-container">
                            <a
                              href={`#auditCancelPopup-${id}`}
                              onClick={handleAuditCancelCard}
                            >
                              <img
                                className="img-border"
                                src="../images/bball.png"
                                alt=""
                              />
                              <div className="notice-new">New</div>
                            </a>
                          </div>
                        </div>
                        <div
                          className="BtnContainer"
                          style={{ display: showCancel }}
                        >
                          <a className="popup__close btn-close" href="#">
                            關閉
                          </a>
                          <a
                            href={`#confirmCancel-${id}`}
                            className="button btn-no"
                            onClick={handleDetailsNotifyCard}
                          >
                            取消行程
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              {auditApplyCard === "apply" && (
                <AuditApplyCard
                  day={day}
                  startTime={startTime}
                  type={type}
                  arena={arena}
                  state={state}
                  id={id}
                  index={popupId}
                  appl={appl}
                  typeStyle={typeStyle}
                  typeFontStyle={typeFontStyle}
                  ellipseBarType={ellipseBar}
                  isApply={"false"}
                />
              )}

              {auditApplyCard === "yes" && (
                <AuditApplyCard
                  day={day}
                  startTime={startTime}
                  type={type}
                  arena={arena}
                  state={state}
                  appl={appl}
                  id={"yes"}
                  typeStyle={typeStyle}
                  typeFontStyle={typeFontStyle}
                  ellipseBarType={ellipseBar}
                  isApply={"true"}
                  onClose={() => handleAuditApplyCard(false)}
                />
              )}
              {auditCancelCard && (
                <AuditCancelCard
                  day={day}
                  startTime={startTime}
                  type={type}
                  arena={arena}
                  state={state}
                  id={id}
                  typeStyle={typeStyle}
                  typeFontStyle={typeFontStyle}
                />
              )}
              {detailsNotifyCard && (
                <DetailsNotifyCard
                  day={day}
                  startTime={startTime}
                  endTime={endTime}
                  type={type}
                  city={city}
                  area={area}
                  arena={arena}
                  tagDegree={tagDegree}
                  tagPrice={tagPrice}
                  id={id}
                  typeStyle={typeStyle}
                  typeFontStyle={typeFontStyle}
                />
              )}
            </>
          );
        };
        /* 建立元件 燈箱效果-審核申請 */
        const AuditApplyCard = ({
          day,
          startTime,
          type,
          arena,
          state,
          id,
          appl,
          index,
          typeStyle,
          typeFontStyle,
          ellipseBarType,
          isApply,
        }) => {
          const [btnDisplay, setBtnDisplay] = useState("flex");
          const [resultDisplay, setResultDisplay] = useState("none");
          const [resultText, setResultText] = useState("");
          const [resultColor, setResultColor] = useState("#1A8D07");
          console.log("元件" + isApply + index);
          useEffect(() => {
            if (isApply === "true") {
              setBtnDisplay("none");
              setResultDisplay("block");
              setResultText("接受申請");
            }
          }, [isApply]);
          /* 審核結果標籤 */
          const auditResult = (type) => {
            let text = "";

            setBtnDisplay("none");
            setResultDisplay("block");
            if (type === "no") {
              text = "已婉拒";
              setResultColor("#FF4F03");
            } else if (type === "yes") {
              text = "接受申請";
            }
            setResultText(text);
          };

          return (
            /* 燈箱效果-=團主審核報名元件 */
            <div className="popup" id={`detailApplyPopup-${id}-${index}`}>
              <div className="popup-inner">
                <div className="popup__content">
                  {/* 團主審核報名元件 */}
                  <div className="audit-apply">
                    <div className="topBtn-container">
                      <a href="#">
                        <img src="../images/waring.png" alt="" />
                      </a>
                      <a className="popup__close" href="#">
                        <img src="../images/cancel.png" alt="" />
                      </a>
                    </div>
                    <div className="audit-info">
                      <div className="selfState-userInfo">
                        <div className="info">
                          <img
                            className="applicantImg"
                            src="../images/player.png"
                            alt=""
                          />
                          <p style={{ color: typeFontStyle }}>{appl[index]}</p>
                        </div>
                        <div className="info">
                          <div className="attendance">
                            <p
                              className="text-M"
                              style={{ color: typeFontStyle }}
                            >
                              85%
                            </p>
                            <img src={ellipseBarType} alt="" />
                          </div>
                          <p style={{ color: typeFontStyle }}>出席率</p>
                        </div>
                        <div className="info">
                          <div className="userInfo">
                            <p style={{ backgroundColor: typeStyle }}>B</p>
                          </div>
                          <p style={{ color: typeFontStyle }}>自評等級</p>
                        </div>
                      </div>
                      <div className="info-remark">
                        <h5>備註（僅限自己可看）：</h5>
                        <p>這個人很愛放鴿子</p>
                      </div>
                      <div className="notice-container">
                        <div
                          className="notice-ballType"
                          style={{ backgroundColor: typeStyle }}
                        >
                          <p>{type}</p>
                        </div>
                        <div className="notice-info">
                          <div>
                            <p style={{ color: typeFontStyle }}>
                              {day} {startTime}
                            </p>
                          </div>
                          <p style={{ color: typeFontStyle }}>{arena}</p>
                          <div className="audit-state">
                            <p>{state}</p>
                          </div>
                        </div>
                      </div>
                      <div className="info-applicantNote">
                        <h5>報名備註：</h5>
                        <p>下班若塞車可能會晚到15分鐘</p>
                      </div>
                      <div
                        className="bottomBtn-container"
                        style={{ display: btnDisplay }}
                      >
                        <button
                          className="button btn-no"
                          onClick={() => auditResult("no")}
                        >
                          婉拒
                        </button>
                        <button
                          className="button btn-yes"
                          onClick={() => auditResult("yes")}
                        >
                          同意申請
                        </button>
                      </div>
                      <div
                        className="audit-state audit-yes"
                        style={{
                          display: resultDisplay,
                          color: resultColor,
                          borderColor: resultColor,
                        }}
                      >
                        <p>{resultText}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          );
        };
        /* 建立元件 燈箱效果-審核取消 */
        const AuditCancelCard = ({
          day,
          startTime,
          type,
          arena,
          state,
          id,
          index,
          typeFontStyle,
          typeStyle,
        }) => {
          const [btnDisplay, setBtnDisplay] = useState("flex");
          const [resultDisplay, setResultDisplay] = useState("none");
          const [resultText, setResultText] = useState("");
          const [resultColor, setResultColor] = useState("#1A8D07");
          /* 審核結果標籤 */
          const auditResult = (type) => {
            let text = "";

            setBtnDisplay("none");
            setResultDisplay("block");
            if (type === "no") {
              text = "已婉拒";
              setResultColor("#FF4F03");
            } else if (type === "yes") {
              text = "同意取消";
            }
            setResultText(text);
          };

          return (
            /* 燈箱效果-=團主審核報名元件 */
            <div className="popup" id={`auditCancelPopup-${id}-${index}`}>
              <div className="popup-inner">
                <div className="popup__content">
                  {/* 團主審核報名元件 */}
                  <div className="audit-apply">
                    <div className="topBtn-container">
                      <a href="#">
                        <img src="../images/waring.png" alt="" />
                      </a>
                      <a className="popup__close" href="#">
                        <img src="../images/cancel.png" alt="" />
                      </a>
                    </div>
                    <div className="audit-info">
                      <div className="info-selfState">
                        <div className="selfState-userInfo">
                          <div className="applicantInfo">
                            <img
                              className="applicantImg"
                              src="../images/player.png"
                              alt=""
                            />
                            <p>Roy</p>
                          </div>
                          <div className="reason-cancel">
                            <h5>取消原因:</h5>
                            <p>手受傷</p>
                          </div>
                        </div>
                        <div className="selfState-title">
                          <h4>取消場次 :</h4>
                        </div>
                      </div>

                      <div className="notice-container">
                        <div
                          className="notice-ballType"
                          style={{ backgroundColor: typeStyle }}
                        >
                          <p>{type}</p>
                        </div>
                        <div className="notice-info">
                          <div>
                            <p style={{ color: typeFontStyle }}>
                              {day} {startTime}
                            </p>
                          </div>
                          <p style={{ color: typeFontStyle }}>{arena}</p>
                          <div className="audit-state">
                            <p>{state}</p>
                          </div>
                        </div>
                      </div>
                      <div
                        className="bottomBtn-container"
                        style={{ display: btnDisplay }}
                      >
                        <button
                          className="button btn-no"
                          onClick={() => auditResult("no")}
                        >
                          婉拒
                        </button>
                        <button
                          className="button btn-yes"
                          onClick={() => auditResult("yes")}
                        >
                          同意取消
                        </button>
                      </div>
                      <div
                        className="audit-state audit-yes"
                        style={{
                          display: resultDisplay,
                          color: resultColor,
                          borderColor: resultColor,
                        }}
                      >
                        <p>{resultText}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          );
        };
        /* 建立元件 燈箱效果-確認取消 */
        const DetailsNotifyCard = ({
          day,
          startTime,
          endTime,
          type,
          city,
          area,
          arena,
          tagDegree,
          tagPrice,
          identity,
          id,
          typeStyle,
          typeFontStyle,
        }) => {
          const [btnDisplay, setBtnDisplay] = useState("flex");
          const [resultDisplay, setResultDisplay] = useState("none");
          const [resultColor, setResultColor] = useState("#1A8D07");
          /* 取消ing標籤 */
          const applicantResult = (type) => {
            setBtnDisplay("none");
            setResultDisplay("block");
            if (type === "cancel") {
              setResultColor("#FF4F03");
            }
          };
          return (
            <>
              <div className="popup" id={`confirmCancel-${id}`}>
                <div className="popup-inner">
                  <div className="popup__content">
                    <div className="simplePostInfo">
                      <div className="main-info">
                        <div
                          className="header"
                          style={{ color: typeFontStyle }}
                        >
                          <p>
                            {day} {startTime}~{endTime}
                          </p>
                          <div
                            className="type-style"
                            style={{ backgroundColor: typeStyle }}
                          >
                            {type}球
                          </div>
                          <a className="popup__close" href="#">
                            <img src="../images/cancel.png" alt="" />
                          </a>
                        </div>
                        <div
                          className="areaInfo"
                          style={{ color: typeFontStyle }}
                        >
                          <h3>{city}</h3>
                          <h3>{area}</h3>
                          <h3>{arena}</h3>
                        </div>
                        <div className="tag-style">
                          <p style={{ backgroundColor: typeFontStyle }}>
                            {tagDegree}
                          </p>
                          <p style={{ backgroundColor: typeFontStyle }}>
                            ${tagPrice}
                          </p>
                        </div>
                      </div>
                      <div className="component-writeBlock">
                        <h5>取消原因：</h5>
                        <input type="text" placeholder="請輸入取消原因"></input>
                      </div>
                      <div
                        className="BtnContainer"
                        style={{ display: btnDisplay }}
                      >
                        <a className="popup__close btn-close" href="#">
                          關閉
                        </a>
                        <button
                          className="button btn-no"
                          onClick={() => applicantResult("cancel")}
                        >
                          確認取消
                        </button>
                      </div>
                      <div
                        className="audit-state audit-cancel"
                        style={{
                          display: resultDisplay,
                          color: resultColor,
                          borderColor: resultColor,
                        }}
                      >
                        <p>取消ing</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </>
          );
        };
        /* 建立元件 燈箱效果-臨打回饋 */
        const EvaluateSponsorCard = ({
          day,
          startTime,
          endTime,
          type,
          city,
          area,
          arena,
          tagDegree,
          tagPrice,
          id,
          state,
          typeStyle,
          typeFontStyle,
          popUp,
          setNewNotifyState,
          setStateStyle,
        }) => {
          //團主評價狀態
          const [newState, setNewState] = useState("");
          const [stateColor, setStateColor] = useState(typeStyle);
          const [btnDisplay, setBtnDisplay] = useState("flex");
          //裝選中的Tags
          const [activeTags, setActiveTags] = useState([]);

          useEffect(() => {
            if (state === "已評價") {
              setNewState("已評價");
              setBtnDisplay("none");
            } else {
              setNewState("未評價");
              setStateColor("#cb1b1b");
            }
            if (newState === "已評價") {
              setBtnDisplay("none");
              setNewNotifyState("已評價");
              setStateStyle("#1a8d07");
            }
          }, [state, newState]);

          const toggleTag = (id) => {
            //放入容器紀錄
            setActiveTags((prevTags) => ({
              ...prevTags, // 展開之前的狀態，保留其他按鈕的狀態不變
              [id]: !prevTags[id], // 只更新特定按鈕的狀態，照之前的狀態取反
            }));
          };

          return (
            <div className="popup" id={`${popUp}-${id}`}>
              <div className="popup-inner">
                <div className="popup__content">
                  <div className="simplePostInfo">
                    <div className="main-info">
                      <div className="header" style={{ color: typeFontStyle }}>
                        <p>
                          {day} {startTime}~{endTime}
                        </p>
                        <div
                          className="type-style"
                          style={{ backgroundColor: typeStyle }}
                        >
                          {type}球
                        </div>
                        <a className="popup__close" href="#">
                          <img src="../images/cancel.png" alt="" />
                        </a>
                      </div>
                      <div
                        className="areaInfo"
                        style={{ color: typeFontStyle }}
                      >
                        <h3>{city}</h3>
                        <h3>{area}</h3>
                        <h3>{arena}</h3>
                      </div>
                      <div className="tag-style">
                        <p style={{ backgroundColor: typeFontStyle }}>
                          {tagDegree}
                        </p>
                        <p style={{ backgroundColor: typeFontStyle }}>
                          ${tagPrice}
                        </p>
                      </div>
                    </div>
                    <div className="line-hugTitle">
                      <div className="titleLine"></div>
                      <h3>球友臨打回饋</h3>
                    </div>
                    <div className="sub-info">
                      <div className="tags" id="vibe">
                        <h4 className="text-L">氣氛</h4>
                        <button
                          id="tags-handSome"
                          className={
                            activeTags["tags-handSome"] ? "active" : ""
                          }
                          onClick={() => toggleTag("tags-handSome")}
                        >
                          有帥哥
                        </button>
                        <button
                          id="tags-prettyGirl"
                          className={
                            activeTags["tags-prettyGirl"] ? "active" : ""
                          }
                          onClick={() => toggleTag("tags-prettyGirl")}
                        >
                          有妹子
                        </button>
                        <button
                          id="tags-friendly"
                          className={
                            activeTags["tags-friendly"] ? "active" : ""
                          }
                          onClick={() => toggleTag("tags-friendly")}
                        >
                          性別友善
                        </button>
                        <button
                          id="tags-coach"
                          className={activeTags["tags-coach"] ? "active" : ""}
                          onClick={() => toggleTag("tags-coach")}
                        >
                          有指導家
                        </button>
                        <button
                          id="tags-relax"
                          className={activeTags["tags-relax"] ? "active" : ""}
                          onClick={() => toggleTag("tags-relax")}
                        >
                          輕鬆歡樂
                        </button>
                        <button
                          id="tags-beginnerFriendly"
                          className={
                            activeTags["tags-beginnerFriendly"] ? "active" : ""
                          }
                          onClick={() => toggleTag("tags-beginnerFriendly")}
                        >
                          新手友善
                        </button>
                      </div>
                      <div className="tags">
                        <h4 className="text-L">程度</h4>
                        <button
                          id="tags-strong"
                          className={activeTags["tags-strong"] ? "active" : ""}
                          onClick={() => toggleTag("tags-strong")}
                        >
                          有強者
                        </button>
                        <button
                          id="tags-longRally"
                          className={
                            activeTags["tags-longRally"] ? "active" : ""
                          }
                          onClick={() => toggleTag("tags-longRally")}
                        >
                          多拍/多來回
                        </button>
                        <button
                          id="tags-matchingLevel"
                          className={
                            activeTags["tags-matchingLevel"] ? "active" : ""
                          }
                          onClick={() => toggleTag("tags-matchingLevel")}
                        >
                          符合徵求程度
                        </button>
                        <button
                          id="tags-beginner"
                          className={
                            activeTags["tags-beginner"] ? "active" : ""
                          }
                          onClick={() => toggleTag("tags-beginner")}
                        >
                          多新手/初階
                        </button>
                      </div>
                      <div className="tags">
                        <h4 className="text-L">團主</h4>
                        <button
                          id="tags-organizer"
                          className={
                            activeTags["tags-organizer"] ? "active" : ""
                          }
                          onClick={() => toggleTag("tags-organizer")}
                        >
                          懂安排程度
                        </button>
                        <button
                          id="tags-overCrowded"
                          className={
                            activeTags["tags-overCrowded"] ? "active" : ""
                          }
                          onClick={() => toggleTag("tags-overCrowded")}
                        >
                          人數超收
                        </button>
                        <button
                          id="tags-generous"
                          className={
                            activeTags["tags-generous"] ? "active" : ""
                          }
                          onClick={() => toggleTag("tags-generous")}
                        >
                          用球大方
                        </button>
                        <button
                          id="tags-rules"
                          className={activeTags["tags-rules"] ? "active" : ""}
                          onClick={() => toggleTag("tags-rules")}
                        >
                          會告知設備/上場規則
                        </button>
                        <button
                          id="tags-dedicated"
                          className={
                            activeTags["tags-dedicated"] ? "active" : ""
                          }
                          onClick={() => toggleTag("tags-dedicated")}
                        >
                          用心
                        </button>
                      </div>
                    </div>
                    <div className="BtnContainer">
                      <a className="popup__close btn-close" href="#">
                        關閉
                      </a>
                      <button
                        className="button btn-yes"
                        style={{
                          display: btnDisplay,
                          backgroundColor: typeFontStyle,
                        }}
                        onClick={() => {
                          setNewState("已評價");
                        }}
                      >
                        送出
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          );
        };
        /* 建立元件 燈箱效果-團主評價 */
        const EvaluateApplicantsCard = ({
          day,
          startTime,
          endTime,
          type,
          city,
          area,
          arena,
          tagDegree,
          tagPrice,
          appl = [],
          id,
          state,
          typeStyle,
          typeFontStyle,
          ellipseBarType,
          popUp,
        }) => {
          //團主評價狀態
          const [newState, setNewState] = useState("");
          const [stateColor, setStateColor] = useState(typeStyle);
          const [newState2, setNewState2] = useState("");
          const [stateColor2, setStateColor2] = useState(typeStyle);

          useEffect(() => {
            if (state === "已評價") {
              setNewState("已評價");
              setNewState2("已評價");
            } else {
              setNewState("未評價");
              setNewState2("未評價");
              setStateColor("#cb1b1b");
              setStateColor2("#cb1b1b");
            }
            if (newState === "已評價") {
              setNewState("已評價");
              setStateColor(typeStyle);
            }
            if (newState2 === "已評價") {
              setNewState2("已評價");
              setStateColor2(typeStyle);
            }
          }, [state, newState, newState2]);

          //
          const [newIndex, setNewIndex] = useState("");

          return (
            <>
              <div className="popup" id={`${popUp}-${id}`}>
                <div className="popup-inner">
                  <div className="popup__content">
                    <div className="simplePostInfo">
                      <div className="main-info">
                        <div
                          className="header"
                          style={{ color: typeFontStyle }}
                        >
                          <p>
                            {day} {startTime}~{endTime}
                          </p>
                          <div
                            className="type-style"
                            style={{ backgroundColor: typeStyle }}
                          >
                            {type}球
                          </div>
                          <a className="popup__close" href="#">
                            <img src="../images/cancel.png" alt="" />
                          </a>
                        </div>
                        <div
                          className="areaInfo"
                          style={{ color: typeFontStyle }}
                        >
                          <h3>{city}</h3>
                          <h3>{area}</h3>
                          <h3>{arena}</h3>
                        </div>

                        <div className="tag-style">
                          <p style={{ backgroundColor: typeFontStyle }}>
                            {tagDegree}
                          </p>
                          <p style={{ backgroundColor: typeFontStyle }}>
                            ${tagPrice}
                          </p>
                        </div>
                      </div>
                      <div className="line-hugTitle">
                        <div className="titleLine"></div>
                        <h3>本場臨打球友</h3>
                      </div>
                      <div className="evaluateContainer">
                        <a
                          href={`#evaluateApplicantsForm-${id}-0`}
                          className="evaluatePlayerList"
                          onClick={() => {
                            setNewIndex("0");
                          }}
                        >
                          <div className="playerName">
                            <img
                              className="applicantImg"
                              src="../images/player.png"
                              alt=""
                            />
                            <p>{appl[0]}</p>
                          </div>

                          <p
                            className="evaluateState-no"
                            style={{ backgroundColor: stateColor }}
                          >
                            {newState}
                          </p>
                        </a>
                        <a
                          href={`#evaluateApplicantsForm-${id}-1`}
                          className="evaluatePlayerList"
                          onClick={() => {
                            setNewIndex("1");
                          }}
                        >
                          <div className="playerName">
                            <img
                              className="applicantImg"
                              src="../images/player2.png"
                              alt=""
                            />
                            <p>{appl[1]}</p>
                          </div>
                          <p
                            className="evaluateState-yes"
                            style={{ backgroundColor: stateColor2 }}
                          >
                            {newState2}
                          </p>
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <EvaluateApplicantsForm
                id={id}
                appl={appl}
                typeStyle={typeStyle}
                typeFontStyle={typeFontStyle}
                ellipseBarType={ellipseBarType}
                newState0={newState}
                newState1={newState2}
                setNewState0={setNewState}
                setNewState1={setNewState2}
                index={newIndex}
              />
            </>
          );
        };
        /* 建立元件 燈箱效果-團主評價表單 */
        const EvaluateApplicantsForm = ({
          id,
          appl,
          typeStyle,
          typeFontStyle,
          ellipseBarType,
          state,
          newState0,
          newState1,
          setNewState0,
          setNewState1,
          index,
        }) => {
          const [btnDisplay, setBtnDisplay] = useState("flex");
          const [resultDisplay, setResultDisplay] = useState("none");
          const [resultText, setResultText] = useState("");
          const [resultColor, setResultColor] = useState("#1A8D07");
          const [stateColor, setStateColor] = useState(typeStyle);

          useEffect(() => {
            if (index === "0" && newState0 === "已評價") {
              auditResult("yes");
              setBtnDisplay("none");
              setResultDisplay("block");
              console.log("yse000");
            } else {
              setBtnDisplay("flex");
              setResultDisplay("none");
            }
            if (index === "1" && newState1 === "已評價") {
              auditResult("yes");
              console.log("yse111");
            } else {
              setBtnDisplay("flex");
              setResultDisplay("none");
            }
          }, [index]);
          /* 審核結果標籤 */
          const auditResult = (type,index) => {
            let text = "";

            setBtnDisplay("none");
            setResultDisplay("block");
            console.log("setBtnDisplay(none);");
            if (type === "blackList") {
              text = "已加入黑名單";
              setResultColor("#FF4F03");
            } else if (type === "yes") {
              text = "已評價";
            }
            setResultText(text);
            if (index === "0") {
              setNewState0("已評價");
              console.log("回傳0 已評價");
            } else if (index === "1") {setNewState1("已評價");}
            //console.log("回傳1 yes");
          };
          return (
            <>
              <div className="popup" id={`evaluateApplicantsForm-${id}-${index}`}>
                <div className="popup-inner">
                  <div className="popup__content">
                    <div className="evaluateForm">
                      <div className="topBtn-container">
                        <a className="popup__close" href={`#evaluateApplyPopup-${id}`}>
                          <img src="../images/cancel.png" alt="" />
                        </a>
                      </div>
                      <div className="selfState-userInfo">
                        <div className="info">
                          <img
                            className="applicantImg"
                            src="../images/player.png"
                            alt=""
                          />
                          <p style={{ color: typeFontStyle }}>{appl[index]}</p>
                        </div>
                        <div className="info">
                          <div className="attendance">
                            <p
                              className="text-M"
                              style={{ color: typeFontStyle }}
                            >
                              85%
                            </p>
                            <img src={ellipseBarType} alt="" />
                          </div>
                          <p style={{ color: typeFontStyle }}>出席率</p>
                        </div>
                        <div className="info">
                          <div className="userInfo">
                            <p style={{ backgroundColor: typeStyle }}>B</p>
                          </div>
                          <p style={{ color: typeFontStyle }}>自評等級</p>
                        </div>
                      </div>

                      <div className="component-writeBlock">
                        <h5>備註（僅限自己可看）：</h5>
                        <input type="text" placeholder="可在此輸入備註" />
                      </div>
                      <fieldset className="evaluateOption">
                        <h5 style={{ color: typeFontStyle }}>出席</h5>
                        <input type="radio" name="出席" id="attend" />
                        <label htmlFor="正常出席">正常出席</label>
                        <input type="radio" name="出席" id="absent" />
                        <label htmlFor="無故出席">無故出席</label>
                      </fieldset>
                      <fieldset className="evaluateOption">
                        <h5 style={{ color: typeFontStyle }}>程度</h5>
                        <input type="radio" name="程度" id="comply" />
                        <label htmlFor="符合自評">符合自評</label>

                        <input type="radio" name="程度" id="uncertainty" />
                        <label htmlFor="符合自評">不確定</label>
                      </fieldset>
                      <div
                        className="BtnContainer"
                        style={{ display: btnDisplay }}
                      >
                        <button
                          href="#"
                          className="button btn-no"
                          onClick={() => auditResult("blackList",index)}
                        >
                          送出,並加入黑名單
                        </button>
                        <button
                          className="button btn-yes"
                          onClick={() => auditResult("yes",index)}
                        >
                          送出
                        </button>
                      </div>
                      <div
                        className="audit-state audit-yes"
                        style={{
                          display: resultDisplay,
                          color: resultColor,
                          borderColor: resultColor,
                        }}
                      >
                        <p>{resultText}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </>
          );
        };

        const App = () => {
          const [selectedButton, setSelectedButton] = useState("btn-itinerary");
          const [noticeType, setNoticeType] = useState("btn-itinerary");
          const itineraryBtn = document.getElementById("btn-itinerary");
          const pastRecordsBtn = document.getElementById("btn-pastRecords");
          /* 改變map的資料 */
          const [callData, setCallData] = useState(future_All_userData);

          const changeNotifyType = (id) => {
            let newType = "";
            setSelectedButton(id);
            setNoticeType(id);
            if (id == "btn-itinerary") {
              newType = "itinerary";
            } else if (id == "btn-pastRecords") {
              newType = "pastRecords";
            }
          };

          const sponsorChange = () => {
            const sponsorBtn = document.querySelector(".btn-sponsor");
            if (sponsorBtn.classList.contains("selected")) {
              sponsorBtn.classList.remove("selected");
              setCallData(future_All_userData);
            } else {
              sponsorBtn.classList.add("selected");
              setCallData(future_host_userData);
            }
          };

          return (
            <div className="body">
              <div className="mobile-TopBar">
                <img
                  src="./images/mobile-both-topbanner.png"
                  alt="不分類的手機版banner"
                />
              </div>
              <header id="topBar">
                <nav id="top-nav">
                  <ul id="menu">
                    <li>
                      <a href="./index.html">
                        <img
                          className="icon"
                          src="./images/magnifier.png"
                          alt=""
                        />
                        探索
                      </a>
                    </li>
                    <li>
                      <a href="./publicationForm.html">
                        <img className="icon" src="./images/post.png" alt="" />
                        找人
                      </a>
                    </li>
                    <li>
                      <a href="notice.html">
                        <img className="icon" src="./images/bell3.png" alt="" />
                        行程
                      </a>
                    </li>
                    <li>
                      <a href="personal.html">
                        <img className="icon" src="./images/cat.png" alt="" />
                        個人
                      </a>
                    </li>
                  </ul>
                </nav>
                <div className="form-title">
                  <div className="hugTitle noto-sans-tc">
                    <img src="./images/vbtitle.svg" alt="" />
                    <h1 className="title-L" value="我的行程">
                      我的行程
                    </h1>
                    <img src="./images/bmtitle.svg" alt="" />
                  </div>
                </div>
              </header>
              <main className="notice-Area">
                <div className="notice-type">
                  <button
                    id="btn-itinerary"
                    className={
                      selectedButton === "btn-itinerary" ? "selected" : ""
                    }
                    onClick={() => changeNotifyType("btn-itinerary")}
                  >
                    未來行程
                  </button>

                  <button
                    id="btn-pastRecords"
                    className={
                      selectedButton === "btn-pastRecords" ? "selected" : ""
                    }
                    onClick={() => changeNotifyType("btn-pastRecords")}
                  >
                    過去紀錄
                  </button>
                </div>
                <div
                  style={{
                    display: noticeType === "btn-itinerary" ? "block" : "none",
                  }}
                >
                  <div className="notice-itineraryTitle">
                    <div className="hugTitle">
                      <h2 className="text-L" value="預定行程">
                        預定行程
                      </h2>
                    </div>
                    <button
                      className="btn-sponsor button"
                      onClick={() => {
                        sponsorChange();
                      }}
                    >
                      <img src="./images/icon-sponsor.png" alt="" />
                      主辦
                    </button>
                  </div>
                  <section className="notice-itineraryArea">
                    {callData.map((post_data) => {
                      return (
                        <Notify
                          name={"所有未來行程貼文"}
                          key={post_data.id}
                          type={post_data.typeAbbr}
                          identity={post_data.identity}
                          day={post_data.dateAbbr}
                          startTime={post_data.startTime}
                          endTime={post_data.endTime}
                          city={post_data.city}
                          area={post_data.area}
                          arena={post_data.arena}
                          tagDegree={post_data.tagDegree}
                          tagPrice={post_data.tagPrice}
                          state={post_data.state}
                          id={post_data.id}
                          role={post_data.role}
                          female={post_data.reqCount[0].count}
                          male={post_data.reqCount[1].count}
                          unspecified={post_data.reqCount[2].count}
                          equip={post_data.equip}
                          note={post_data.note}
                          ballBrand={post_data.ballBrand}
                          appl={post_data.appl}
                          cancel={post_data.cancel}
                        />
                      );
                    })}
                  </section>

                  <div className="notice-itineraryTitle">
                    <div className="hugTitle">
                      <h2 className="text-L" value="取消行程">
                        取消行程
                      </h2>
                    </div>
                  </div>
                  <section className="notice-itineraryArea">
                    {future_cancel_userData.map((post_data) => {
                      return (
                        <Notify
                          name={"所有未來取消貼文"}
                          key={post_data.id}
                          type={post_data.typeAbbr}
                          identity={post_data.identity}
                          day={post_data.dateAbbr}
                          startTime={post_data.startTime}
                          endTime={post_data.endTime}
                          city={post_data.city}
                          area={post_data.area}
                          arena={post_data.arena}
                          tagDegree={post_data.tagDegree}
                          tagPrice={post_data.tagPrice}
                          state={post_data.state}
                          id={post_data.id}
                          role={post_data.role}
                          female={post_data.reqCount[0].count}
                          male={post_data.reqCount[1].count}
                          unspecified={post_data.reqCount[2].count}
                          equip={post_data.equip}
                          note={post_data.note}
                        />
                      );
                    })}
                  </section>
                </div>
                <div
                  style={{
                    display:
                      noticeType === "btn-pastRecords" ? "block" : "none",
                  }}
                >
                  <section className="notice-itineraryArea">
                    {past_ALL_userData.map((post_data) => {
                      return (
                        <Notify
                          name="所有過去貼文"
                          key={post_data.id}
                          type={post_data.typeAbbr}
                          identity={post_data.identity}
                          day={post_data.dateAbbr}
                          startTime={post_data.startTime}
                          endTime={post_data.endTime}
                          city={post_data.city}
                          area={post_data.area}
                          arena={post_data.arena}
                          tagDegree={post_data.tagDegree}
                          tagPrice={post_data.tagPrice}
                          state={post_data.state}
                          id={post_data.id}
                          role={post_data.role}
                          female={post_data.reqCount[0].count}
                          male={post_data.reqCount[1].count}
                          unspecified={post_data.reqCount[2].count}
                          appl={post_data.appl}
                        />
                      );
                    })}
                  </section>
                </div>
              </main>

              <footer>
                <figure className="footer-border"></figure>
                <div>
                  <figure>
                    <img
                      id="logo"
                      src="./images/logo.png"
                      alt="logo-PlayBallNow"
                    />
                  </figure>
                  <p>Copyright© 2024 PlayBallNow. All Right Reserved. </p>
                </div>
              </footer>
            </div>
          );
        };
        ReactDOM.createRoot(document.getElementById("root")).render(<App />);
      })();
    </script>
  </body>
</html>
